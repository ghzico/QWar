# Tasks: 回合制与棋将血量、怪物 AI

## 1. 棋将血量（配置与数据）

- [x] 1.1 在 HeroConfig 中新增 GHp（血量）字段
- [x] 1.2 在 GeneralConfigLoader 中解析 General.xlsx 的「血量」或「GHp」列；缺列或无效时使用默认值（如 1）
- [x] 1.3 在 ApplyToHero 中设置棋将初始/最大血量（ChessHero 需暴露设置方法或属性）
- [x] 1.4 在 ChessHero 中增加当前血量、最大血量（或仅当前血量），及 TakeDamage(int amount)；扣血后更新显示，血量为 0 时从棋盘移除并 QueueFree
- [x] 1.5 在 ChessHero 场景中增加血量显示（Label 或进度条），并在血量变化时更新

## 2. 回合系统

- [x] 2.1 在 FightBoard（或等价处）维护当前回合归属（我方/怪物方）与本回合剩余行为次数（我方回合时为 2）
- [x] 2.2 我方每次成功执行一次移动或攻击后，剩余行为次数减 1；若变为 0 则切换为怪物方回合
- [x] 2.3 我方回合时，仅当当前为我方回合且剩余行为次数 > 0 时才允许对棋将执行移动/攻击；否则不响应或提示等待怪物回合结束
- [x] 2.4 怪物方回合开始时，按顺序为每只存活怪物执行 AI（每只最多 2 次行为）；全部完成后切换为我方回合并重置剩余行为次数为 2

## 3. 怪物 AI 与攻击棋将

- [x] 3.1 实现“获取距离某怪物曼哈顿距离最近的存活棋将”的查询（若多只等距则按行列序取一）
- [x] 3.2 怪物方回合内：若怪物与目标棋将邻格（曼哈顿距离 1），则执行一次攻击（对棋将造成 1 点伤害），消耗 1 次行为
- [x] 3.3 若怪物与目标棋将不邻格，则向目标方向移动一格（使曼哈顿距离减 1 的合法空格），消耗 1 次行为；每只怪物每回合最多 2 次行为
- [x] 3.4 为 ChessEnemy 提供“移动一格”能力（更新棋盘格子注册与位置）；怪物攻击距离与移动距离均为 1
- [x] 3.5 扩展 FightBoard 或伤害逻辑：怪物攻击时对棋将所在格调用棋将的 TakeDamage(1)；确保棋将死亡时从棋盘移除

## 4. 文档与收尾

- [x] 4.1 在 OPENSPEC.md 中补充 General.xlsx 表头说明：新增「血量」或「GHp」列及含义
- [x] 4.2 验证完整流程：我方回合两次行为 → 怪物方回合每怪最多两次行为 → 切换回我方；棋将血量从配置读取、受击扣血与显示、死亡移除均正常
