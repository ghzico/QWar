# Spec: turn-system

## ADDED Requirements

### Requirement: 回合归属与切换

系统 SHALL 维护当前回合归属（我方 / 怪物方），并在我方回合耗尽两次行为或怪物方所有怪物完成两次行为后，切换到另一方回合。

#### Scenario: 我方回合开始

- **WHEN** 游戏开始或怪物方回合结束
- **THEN** 当前回合归属为我方；本回合剩余行为次数为 2；玩家可对己方棋将执行移动或攻击，每次成功执行消耗 1 次行为

#### Scenario: 我方回合结束

- **WHEN** 我方在本回合内已消耗 2 次行为（两次移动、或两次攻击、或一次移动+一次攻击）
- **THEN** 系统自动将回合切换为怪物方；怪物方回合开始

#### Scenario: 怪物方回合开始

- **WHEN** 回合切换为怪物方
- **THEN** 系统按既定顺序（如棋盘上的顺序）为每只存活的怪物执行 AI；每只怪物最多执行 2 次行为（每次为一次移动或一次攻击）

#### Scenario: 怪物方回合结束

- **WHEN** 所有存活怪物均已完成本回合的两次行为（或无可执行行为）
- **THEN** 系统将回合切换为我方；我方回合开始，剩余行为次数重置为 2

---

### Requirement: 每回合两次行为

每方在己方回合内 SHALL 拥有且仅拥有 2 次“行为”；每次行为 SHALL 为一次移动或一次攻击，由玩家（我方）或 AI（怪物方）选择执行。

#### Scenario: 我方单次行为消耗

- **WHEN** 我方回合内，玩家对某棋将执行一次移动或一次攻击并成功完成
- **THEN** 本回合剩余行为次数减 1；若变为 0 则我方回合结束并切换至怪物方

#### Scenario: 怪物单次行为消耗

- **WHEN** 怪物方回合内，某怪物执行一次移动或一次攻击
- **THEN** 该怪物本回合剩余行为次数减 1；若该怪物已用尽 2 次或无可执行目标，则处理下一只怪物；全部处理完毕则怪物方回合结束

#### Scenario: 行为类型唯一性

- **WHEN** 执行一次行为
- **THEN** 该次行为仅计为“一次移动”或“一次攻击”，不能一次行为同时完成移动与攻击
